<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Formulaire Tennis Club de Pimprez</title>
</head>
<body>
    <div id="confirmation-message">
        <h3>Inscription envoyée avec succès !</h3>
        <p>Vos informations ont bien été envoyées à notre équipe. Merci !</p>
        <button id="btn-new-inscription" class="btn btn-success mt-3">Faire une nouvelle inscription</button>
    </div>
    <form id="inscriptionForm">
        <!-- champs simplifiés pour test -->
        <input type="text" name="nom" placeholder="Nom">
        <input type="text" name="adresse" placeholder="Adresse">
        <input type="text" name="code_postal" placeholder="Code postal">
        <input type="text" name="ville" placeholder="Ville">
        <input type="tel" name="tel_mobile" placeholder="Téléphone">
        <input type="email" name="email" placeholder="Email">
        <button type="submit">Envoyer</button>
    </form>
    
<script>
// ✨ Amélioration : conservez les données familiales partagées entre membres (adresse, ville, email...) + bouton Ajouter un membre

const confirmationMessage = document.getElementById("confirmation-message");
confirmationMessage.style.display = "none";

const form = document.getElementById("inscriptionForm");

// Mémoriser les champs partagés (coordonnées) entre membres d'une même famille
let coordonneesPartagees = {};
const champsFamille = ["adresse", "code_postal", "ville", "email", "tel_mobile", "tel_fixe"];

// Charger les coordonnées déjà mémorisées au démarrage
window.addEventListener("DOMContentLoaded", () => {
    champsFamille.forEach(champ => {
        const champInput = document.querySelector(`[name='${champ}']`);
        if (champInput && coordonneesPartagees[champ]) {
            champInput.value = coordonneesPartagees[champ];
        }
    });
});

form.addEventListener("submit", function(e) {
    e.preventDefault();

    const formData = new FormData(form);
    const data = Object.fromEntries(formData.entries());

    // Stocker les champs partagés pour réutilisation
    champsFamille.forEach(champ => {
        coordonneesPartagees[champ] = data[champ] || "";
    });

    fetch("https://usebasin.com/f/28ad0c57c7ea", {
        method: "POST",
        body: formData,
    })
    .then(response => {
        if (response.ok) {
            form.style.display = "none";
            confirmationMessage.style.display = "block";

            // Créer bouton Ajouter un membre si absent
            if (!document.getElementById("btn-add-member-simple")) {
                const btn = document.createElement("button");
                btn.id = "btn-add-member-simple";
                btn.className = "btn btn-outline-success mt-3";
                btn.textContent = "Ajouter un autre membre de la même famille";
                btn.onclick = () => {
                    confirmationMessage.style.display = "none";
                    form.style.display = "block";
                    form.reset();
                    champsFamille.forEach(champ => {
                        if (coordonneesPartagees[champ]) {
                            const champInput = document.querySelector(`[name='${champ}']`);
                            if (champInput) champInput.value = coordonneesPartagees[champ];
                        }
                    });
                };
                confirmationMessage.appendChild(btn);
            }
        } else {
            alert("Erreur lors de l'envoi du formulaire. Veuillez réessayer.");
        }
    })
    .catch(error => {
        console.error("Erreur réseau:", error);
        alert("Une erreur s'est produite. Veuillez réessayer plus tard.");
    });
});

// Bouton classique "Nouvelle inscription"
const btnNewInscription = document.getElementById("btn-new-inscription");
btnNewInscription.addEventListener("click", () => {
    confirmationMessage.style.display = "none";
    form.style.display = "block";
    form.reset();
    champsFamille.forEach(champ => {
        if (coordonneesPartagees[champ]) {
            const champInput = document.querySelector(`[name='${champ}']`);
            if (champInput) champInput.value = coordonneesPartagees[champ];
        }
    });
});
</script>

</body>
</html>
